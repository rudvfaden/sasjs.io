---
marp: true
theme: default
paginate: true
<!--
npx @marp-team/marp-cli slides.md ./theme/slides.html
-->

---
<!-- header: ![h:5em](https://sasjs.io/img/js-logo700x389.png)-->

# DevOps with SASjs
## Allan Bowe

![bg right:33% height:250 ](https://datacontroller.io/wp-content/uploads/2020/10/abow.png)

<!-- TRANSCRIPT
Hello, my name's Allan Bowe, I've been a SAS App developer for.. a number of years, and in this session we're going to do a bit of a deep dive into automated deployments using the SASjs CLI.
-->


---

# Why Choose SASjs?

- Open Source (MIT)
- Cross Platform (Base SAS, SAS 9, Viya)
- Active Development & Support

---

# Why Use SASjs?

- Git-Native SAS Projects
  - compile & build _locally_
  - deploy & execute _remotely_
- Self-Documenting
- Test Driven Development


---
# Where to use SASjs?

- VS Code / local IDE
- Jenkins / scheduling systems
- Bitbucket / Gitlab Pipelines, Github Actions
- GIT Hooks
- Web Apps
- Data Engineering / Data Science projects

---
# SASjs Framework

- [@sasjs/core](https://github.com/sasjs/core) - Macro library
- [@sasjs/adapter](https://github.com/sasjs/adapter) - SAS Server Connectivity
- [@sasjs/cli](https://github.com/sasjs/cli) - CI/CD and Automated Deployment


---
# SASjs Core

- ~150 macros geared towards Application Development
- Functions, Procedures, Metadata, Viya
- `npm install @sasjs/core`

![bg right:50% height:700](https://i.imgur.com/K43rKHb.png)

---
# SASjs Adapter

- Authentication
- Bidirectional communication with SAS
- `npm install @sasjs/adapter`

---
# SASjs CLI

- Opinionated Project Setup
- DevOps
- `npm install --global @sasjs/cli`

---
# `sasjs create`

- Prepare a SAS project with an opinionated structure
- Structure is documented within `sasjsconfig.json`
- Templates:
    - `sasjs create myapp -t jobs`
    - `sasjs create myapp -t minimal`
    - `sasjs create myapp -t react`
    - `sasjs create myapp -t angular`

---
# Project Structure

![bg right:71% height:700](https://sasjs.io/img/sasjs-cli-create.png)

---
# `sasjs add`

- Define a Target
- Client / Secret
- App Location (`appLoc`)

![bg right:68% width:870 ](https://i.imgur.com/SaNVk0N.png)

---

# `sasjs run`

- `sasjs run code.sas`

![bg right:60% height:450](https://sasjs.io/img/sasjsrun1.png)

---
# sasjs doc

![bg right:72% ](https://i.imgur.com/mIlgZqh.png)

---
# Data Lineage

![bg right:72% ](https://sasjs.io/img/sasjs-cli-lineage.png)

---
# Doxygen Headers

![bg right:72% ](https://sasjs.io/img/sasjs-cli-doc.png)

---

# sasjsconfig.json

- Project configuration
  - docConfig
  - testConfig
  - jobConfig
  - deployConfig
  - macroFolders
  - ...
- root / target level

![bg right:60% height:450](https://sasjs.io/img/sasjsconfig.png)

---
# `sasjs compile`

- One file per Job / Service / Test
- Init + Term programs
- Macro Variables

![bg right:50% height:650px](https://cli.sasjs.io/img/sasjscompile.png?_=1)

---
# sasjsbuild directory

![bg right:40% height:700px](https://i.imgur.com/r73fl9W.png)

---
# `sasjs build`

- Many files to 1 (or 2)
    - SAS program (SAS 9 + Viya)
        - Generated by default
    - JSON file (Viya only)
        - if `deployServicePack:true`

![bg right:40% height:700px](https://cli.sasjs.io/img/sasjsbuild.png)


---
# `sasjs deploy`

- Loads JSON if `deployServicePack:true` and `serverType:"SASVIYA`
- Executes `tgtDeployScripts`:
    - SAS Programs remotely
    - Everything else, locally
- Compile, build & deploy in one step:  `sasjs cbd`

![bg right:50% height:700px](https://i.imgur.com/uZ8avwk.png)


<!--
Deploy then, will first deploy the folders and services using the REST APIs if the target is Viya and `deployServicePack` is true.
 After that it executes everything within the `tgtDeployScripts` array- on the server if it's a SAS file, or locally if anything else.  This is where you can add logic for building & deploying your frontend, such as npm run build, and rsync.

On the right is an example of a target configuration which shows how you can set this up.

-->

---
<!-- header: ![h:3em](https://sasjs.io/img/js-logo700x389.png)-->


| Command |Description|
|:-------:|:----:|
|   [add](https://cli.sasjs.io/add)   | Provides a series of prompts used to define a SAS  [target](https://sasjs.io/glossary#target ) along with the relevant connection details (if SAS Viya) |
|[build](https://cli.sasjs.io/build)  |takes all of the input jobs and services and creates a build pack|
|[compile](https://cli.sasjs.io/compile)|Extracts all the dependencies and input programs for each service / job and includes them in a single file ready for deployment|
|[context](https://cli.sasjs.io/context)|List, export, create, edit, and delete SAS Compute contexts|
|[create](https://cli.sasjs.io/create)| Initialise a SASjs repository, either in plain form or using a range of templates|
|[deploy](https://cli.sasjs.io/deploy)|Perform the actual deployment of a SASjs project into SAS 9 or Viya|
|[folder](https://cli.sasjs.io/folder)|Management of logical Viya folders|
|[job](https://cli.sasjs.io/job)|Manage & Execute SAS Jobs|
|[run](https://cli.sasjs.io/run)|Run arbitrary SAS code in a Viya Compute Session, directly from the terminal (or commandline session)|
|[servicepack](/servicepack)|The SASjs Service Pack is a collection of services and folder objects.  The servicepack command lets you deploy them easily|

<!-- TRANSCRIPT
As you've seen there are quite a few commands, and we're still in the process of documenting them all.
If there are any more commands that you know would be helpful, that you'd like to see, just head over to the repo and raise an issue.  If there's community support, we'd be happy to build it in.

visit github, sasjs.io, cli.sasjs.io, core.sasjs.io, adapter.sasjs.io
-->

---
<!-- header: ![h:6em](https://sasjs.io/img/js-logo700x389.png)-->

# Allan Bowe, Head of SAS Apps


- https://www.linkedin.com/in/allanbowe/
- allan.bowe@analytium.co.uk
- https://github.com/sasjs

<!--
My contact details and the github link are right here, feel free to reach out if you'd like to know more, we'd be happy to arrange a 1 hour workshop or a longer training session for you and your team.

Do widzenia!
-->

